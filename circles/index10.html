<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FGM</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,500,700" rel="stylesheet">
    <link href="style.css" rel="stylesheet"/>
</head>
<body>
<div class="container">
    <div class="row">
        <h1 class="col-md-12">FGM by wealth</h1>
         <div id='plot1' class="col-md-12"></div>
    </div>
</div>
<div id="content">
<!--    <div class="mapInfo">Hover over a country</div>-->
    <svg width="620px" height="600px">
      <g class="map"></g>
      <g class="bounding-box"><rect></rect></g>
      <g class="centroid"><circle r="4"></circle></g>
		<text class="mapInfo"  x="50px" y = "350px">
			<tspan id="mapCountryText"  x="50" dy="1.2em">Hover over a country</tspan>
			<tspan id="mapDataText" x="50" dy="1.2em"></tspan>
		</text>
		
    </svg>
  </div>
	<script src="https://d3js.org/d3.v4.min.js"></script>

	
	<script>

    // Based on D3 in Depth (http://d3indepth.com/)

    var projection = d3.geoMercator()
      .scale(400)
      .translate([200, 280])
      .center([0, 5]);

    var geoGenerator = d3.geoPath()
      .projection(projection);

    var handleMouseover = d => {
      var pixelArea = geoGenerator.area(d);
      var bounds = geoGenerator.bounds(d);
      var centroid = geoGenerator.centroid(d);
      var measure = geoGenerator.measure(d);

	var nameCountry = d.properties.name;

	 d3.json('data/0-14data.json', function(err, json) {
		 var data10 = json;
		 try{
			 something = data10[nameCountry].prevalence + "%";
		 }
		 catch(error){
			 something = 'No data available';
		 }
		 console.log(something);
      	d3.select('#content .mapInfo #mapCountryText')
		 	.text(d.properties.name + ":");
		d3.select('#content .mapInfo #mapDataText')
		 	.text(something);
    });

      d3.select('#content .bounding-box rect')
        .attr('x', bounds[0][0])
        .attr('y', bounds[0][1])
        .attr('width', bounds[1][0] - bounds[0][0])
        .attr('height', bounds[1][1] - bounds[0][1]);

      d3.select('#content .centroid')
        .style('display', 'inline')
        .attr('transform', `translate(${centroid})`);
    };

    var update = geojson => {
      var u = d3.select('#content g.map')
        .selectAll('path')
        .data(geojson.features);

      u.enter()
        .append('path')
//		.style("fill", function(d) {
//		  
//		  var mapID = d.properties.name;
//		  console.log(mapID);
//          var color = "#f7f7f7"; //default color for those without information
//		  var prevalence = 100;
//		  
//		  d3.json('data/0-14data.json', function(err, json) {
//		 		var data10 = json;
//			  try 
//			  prevalence = data10[mapID].prevalence;
//		  });
//		  console.log(prevalence);
////            var Prevalence = (populationPerState.get(mapID)).estimate2017;
//
////            data.forEach(function(e){
////               if (mapID === e.id){
////                   color = scaleColor(e.total/statePopulation)
////               }
////            });
//
//            return color
//	  })
        .attr('d', geoGenerator)
        .on('mouseover', handleMouseover);
    };

    // Fetch data
    d3.json('africa.json', function(err, json) {
      update(json)
    });

  </script>

<script src="script_10.js"></script>
</body>
</html>